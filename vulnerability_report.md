# セキュリティ脆弱性診断レポート

## 概要
コードベースの静的解析を行い、セキュリティ上の懸念点と改善推奨事項をまとめました。
直ちに悪用可能な致命的な脆弱性は確認されませんでしたが、セキュリティベストプラクティスに基づき、以下の点について改善を推奨します。

## 検出されたリスクと改善案

### 1. 機密情報と設定のハードコーディング
- **リスクレベル**: 中
- **詳細**: APIのエンドポイントやFirebaseの設定情報がソースコード内に直接記述されています。これらの情報がハードコードされていると、開発・本番環境の切り替えが困難になるほか、ソースコード流出時にバックエンドの構成が露見するリスクがあります。
- **該当箇所**:
  - `src/pages/MyPage/Setting.jsx`
  - `src/pages/Login.jsx`
- **推奨される対策**:
  - 環境変数（`.env`ファイル）を使用し、ビルド時に値を注入するように変更することを強く推奨します（例: `import.meta.env.VITE_API_BASE_URL`）。

### 2. 認証トークンの保存場所 (XSSリスク)
- **リスクレベル**: 中
- **詳細**: JWT（認証トークン）を `localStorage` および `sessionStorage` に保存しています。`localStorage` はJavaScriptからアクセス可能なため、もし将来的にアプリ内にクロスサイトスクリプティング（XSS）脆弱性が生じた場合、攻撃者によってトークンが窃取される恐れがあります。
- **該当箇所**:
  - `src/pages/Login.jsx`
  - `src/App.jsx`
- **推奨される対策**:
  - セキュリティを最優先する場合は、トークンを `HttpOnly Cookie` に保存する方式への移行を検討してください。

### 3. コンソールへの機密情報の出力
- **リスクレベル**: 低〜中
- **詳細**: 開発用と思われる `console.log` が残っており、ログイン成功時のレスポンス（トークンやユーザー情報を含む）が出力されています。ユーザーが開発者ツールを開いている場合や、悪意のあるブラウザ拡張機能によって情報が読み取られる可能性があります。
- **該当箇所**:
  - `src/pages/Login.jsx`: `console.log("ログイン成功:", data);`
  - `src/pages/MyPage/Setting.jsx`: `console.log("Fetched Devices:", data.device);`
- **推奨される対策**:
  - 本番ビルド時には `console.log` を削除するか、機密情報を含むログ出力を削除してください。

### 4. クライアントサイドの認証チェックの不備
- **リスクレベル**: 低
- **詳細**: ルート保護（`PrivateRoute`）における認証チェックが、トークンの「有無」のみを確認しています。トークンの有効性検証が行われていないため、ブラウザのストレージにダミー値をセットするだけで画面遷移が可能となってしまいます（APIアクセスはサーバー側で拒否されますが、UIが表示されてしまうのは望ましくありません）。
- **該当箇所**:
  - `src/App.jsx`
- **推奨される対策**:
  - トークンの有無だけでなく、有効期限や署名の簡易チェック、または起動時に `/me` エンドポイント等を叩いてトークンの有効性を確認するロジックを追加することを推奨します。

### 5. 個人情報（メールアドレス）のローカル保存
- **リスクレベル**: 低
- **詳細**: ユーザーの利便性のために次回ログイン用にメールアドレスを `localStorage` に保存しています。共有端末などで使用された場合、第三者にメールアドレスを知られるリスクがあります。
- **該当箇所**:
  - `src/pages/Login.jsx`
- **推奨される対策**:
  - 利便性とのトレードオフになりますが、保存するかどうかをユーザーが選択できるようにするか、リスクを許容する必要があります。

---
*このレポートは静的解析に基づくものであり、コードの変更は行っていません。*
